<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>聆听自己</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", system-ui, sans-serif;
      background: #f8f6f2;
      color: #222;
      padding-bottom: 90px; /* 给底部播放器留空间 */
    }
    body.dark {
      background: #111827;
      color: #f9fafb;
    }
    header {
      padding: 16px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid #e5e1d8;
      background: rgba(248,246,242,0.9);
      backdrop-filter: blur(10px);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    body.dark header {
      background: rgba(17,24,39,0.9);
      border-bottom-color: #374151;
    }
    .logo {
      font-size: 18px;
      font-weight: 600;
      letter-spacing: 1px;
    }
    .mode-toggle {
      font-size: 18px;
      cursor: pointer;
      user-select: none;
    }
    main {
      padding: 20px;
      max-width: 720px;
      margin: 0 auto;
    }
    .intro {
      font-size: 14px;
      color: #666;
      margin-bottom: 16px;
    }
    body.dark .intro { color: #9ca3af; }

    .playlist {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .track {
      padding: 12px 14px;
      border-radius: 12px;
      background: #ffffff;
      border: 1px solid #eee4d5;
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease, border-color 0.1s ease;
    }
    .track:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.04);
      border-color: #e1c89f;
    }
    .track.active {
      border-color: #d6b470;
      box-shadow: 0 4px 10px rgba(0,0,0,0.06);
    }
    body.dark .track {
      background: #111827;
      border-color: #374151;
    }
    body.dark .track:hover {
      border-color: #9ca3af;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    .track-title {
      font-size: 16px;
      font-weight: 500;
      margin-bottom: 4px;
    }
    .track-desc {
      font-size: 13px;
      color: #777;
      margin-bottom: 6px;
    }
    body.dark .track-desc { color: #9ca3af; }
    .track-meta {
      font-size: 12px;
      color: #aa8f53;
    }
    body.dark .track-meta { color: #e5b96b; }

    .player {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      border-top: 1px solid #e5e1d8;
      background: #fdfbf7;
      padding: 8px 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      z-index: 20;
    }
    body.dark .player {
      background: #020617;
      border-top-color: #374151;
    }
    .player-main {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }
    .player-info {
      flex: 1;
      min-width: 0;
    }
    .player-title {
      font-size: 14px;
      font-weight: 500;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .player-sub {
      font-size: 11px;
      color: #888;
    }
    body.dark .player-sub { color: #9ca3af; }

    .player-controls {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .btn {
      border: none;
      background: none;
      padding: 4px 6px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 999px;
    }
    .btn:hover {
      background: rgba(0,0,0,0.05);
    }
    body.dark .btn:hover {
      background: rgba(255,255,255,0.06);
    }
    .btn-main {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: 1px solid #d6b470;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      background: #fffaf1;
    }
    body.dark .btn-main {
      border-color: #e5b96b;
      background: #111827;
      color: #f9fafb;
    }

    .progress-wrap {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    #progress {
      flex: 1;
      -webkit-appearance: none;
      appearance: none;
      height: 4px;
      border-radius: 999px;
      background: #e4ded2;
    }
    #progress::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #d6b470;
      cursor: pointer;
      margin-top: -4px;
    }
    .time-label {
      font-size: 11px;
      color: #999;
      width: 36px;
      text-align: center;
    }
    body.dark .time-label { color: #9ca3af; }
    .speed-btn {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid #ddd;
      background: #fff;
      cursor: pointer;
    }
    body.dark .speed-btn {
      background: #111827;
      border-color: #4b5563;
      color: #e5b96b;
    }

    @media (max-width: 480px) {
      header { padding: 12px 16px; }
      main { padding: 16px; }
      .track { padding: 10px 12px; }
      .player-main { gap: 4px; }
      .player-title { font-size: 13px; }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">静听经声</div>
    <div class="mode-toggle" id="modeToggle">☀︎</div>
  </header>

  <main>
    <p class="intro">常随佛学</p>

    <section class="playlist" id="playlist">
      <!-- 把 data-src 换成你自己的音频路径 -->
      <article class="track" data-src="audio/heart-sutra.mp3">
        <div class="track-title">《心经》</div>
        <div class="track-desc">短篇经典，适合日常静心与入门。</div>
        <div class="track-meta">10 min · 静心</div>
      </article>

      <article class="track" data-src="audio/amitabha.mp3">
        <div class="track-title">《阿弥陀经》</div>
        <div class="track-desc">专注念佛，放下杂念，安住当下。</div>
        <div class="track-meta">25 min · 安心</div>
      </article>

      <article class="track" data-src="audio/diamond-sutra.mp3">
        <div class="track-title">《金刚经》节选</div>
        <div class="track-desc">思维观照，体会无常与放下。</div>
        <div class="track-meta">15 min · 观照</div>
      </article>
    </section>
  </main>

  <!-- 底部播放器 -->
  <footer class="player">
    <div class="player-main">
      <div class="player-info">
        <div class="player-title" id="playerTitle">选择一部经文开始聆听</div>
        <div class="player-sub" id="playerSub">点击上方列表播放</div>
      </div>
      <div class="player-controls">
        <button class="btn" id="prevBtn">⟨</button>
        <button class="btn btn-main" id="playPauseBtn">▶</button>
        <button class="btn" id="nextBtn">⟩</button>
      </div>
    </div>
    <div class="progress-wrap">
      <span class="time-label" id="currentTime">0:00</span>
      <input type="range" id="progress" min="0" max="100" value="0" />
      <span class="time-label" id="duration">0:00</span>
      <button class="speed-btn" id="speedBtn">1.0x</button>
    </div>
    <audio id="audio"></audio>
  </footer>

  <script>
    const tracks = Array.from(document.querySelectorAll('.track'));
    const audio = document.getElementById('audio');

    const playerTitle = document.getElementById('playerTitle');
    const playerSub = document.getElementById('playerSub');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const progress = document.getElementById('progress');
    const currentTimeEl = document.getElementById('currentTime');
    const durationEl = document.getElementById('duration');
    const speedBtn = document.getElementById('speedBtn');
    const modeToggle = document.getElementById('modeToggle');

    let currentIndex = -1;
    let isPlaying = false;
    const speeds = [1.0, 1.25, 1.5];
    let speedIndex = 0;

    function formatTime(sec) {
      if (!sec || isNaN(sec)) return '0:00';
      const m = Math.floor(sec / 60);
      const s = Math.floor(sec % 60);
      return m + ':' + String(s).padStart(2, '0');
    }

    function setActiveTrack(index) {
      tracks.forEach((t, i) => {
        t.classList.toggle('active', i === index);
      });
    }

    function loadTrack(index) {
      const track = tracks[index];
      if (!track) return;
      const src = track.dataset.src;
      const title = track.querySelector('.track-title').textContent;
      const desc = track.querySelector('.track-desc').textContent;

      audio.src = src;
      currentIndex = index;
      playerTitle.textContent = title;
      playerSub.textContent = desc;
      setActiveTrack(index);
      audio.load();
      audio.play().then(() => {
        isPlaying = true;
        playPauseBtn.textContent = '⏸';
      }).catch(() => {
        isPlaying = false;
        playPauseBtn.textContent = '▶';
      });
    }

    // 点击列表播放
    tracks.forEach((track, index) => {
      track.addEventListener('click', () => {
        if (index === currentIndex && isPlaying) {
          audio.pause();
        } else {
          loadTrack(index);
        }
      });
    });

    // 播放/暂停按钮
    playPauseBtn.addEventListener('click', () => {
      if (!audio.src) {
        loadTrack(0);
        return;
      }
      if (isPlaying) {
        audio.pause();
      } else {
        audio.play();
      }
    });

    audio.addEventListener('play', () => {
      isPlaying = true;
      playPauseBtn.textContent = '⏸';
    });

    audio.addEventListener('pause', () => {
      isPlaying = false;
      playPauseBtn.textContent = '▶';
    });

    // 上一首 / 下一首
    prevBtn.addEventListener('click', () => {
      if (currentIndex <= 0) {
        loadTrack(tracks.length - 1);
      } else {
        loadTrack(currentIndex - 1);
      }
    });

    nextBtn.addEventListener('click', () => {
      if (currentIndex >= tracks.length - 1 || currentIndex === -1) {
        loadTrack(0);
      } else {
        loadTrack(currentIndex + 1);
      }
    });

    // 进度条 & 时间
    audio.addEventListener('timeupdate', () => {
      const { currentTime, duration } = audio;
      currentTimeEl.textContent = formatTime(currentTime);
      durationEl.textContent = formatTime(duration);
      if (duration) {
        progress.value = (currentTime / duration) * 100;
      }
    });

    progress.addEventListener('input', () => {
      const { duration } = audio;
      if (!duration) return;
      const newTime = (progress.value / 100) * duration;
      audio.currentTime = newTime;
    });

    audio.addEventListener('ended', () => {
      nextBtn.click();
    });

    // 倍速按钮
    speedBtn.addEventListener('click', () => {
      speedIndex = (speedIndex + 1) % speeds.length;
      const newSpeed = speeds[speedIndex];
      audio.playbackRate = newSpeed;
      speedBtn.textContent = newSpeed.toFixed(2) + 'x';
    });

    // 简单暗色模式切换
    modeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark');
      if (document.body.classList.contains('dark')) {
        modeToggle.textContent = '☾';
      } else {
        modeToggle.textContent = '☀︎';
      }
    });
  </script>
</body>
</html>
